- Tasas de inter√©s de referencia del Banco Central Europeo (BCE): Data recogido aqui:
https://www.ecb.europa.eu/stats/policy_and_exchange_rates/key_ecb_interest_rates/html/index.en.html
https://data.ecb.europa.eu/data/datasets/IRS?dataset%5B0%5D=Long-term%20interest%20rate%20statistics%20%28IRS%29&advFilterDataset%5B0%5D=Long-term%20interest%20rate%20statistics%20%28IRS%29
- √çndice Euro Stoxx 50:
Downloaded from https://finance.yahoo.com/quote/%5ESTOXX50E/history/?period1=1420070400&period2=1761177600

3. Extracci√≥n con Spark:

Una vez que hayas identificado los datos, puedes usar Spark para extraerlos de Eurostat. Aqu√≠ tienes un ejemplo de c√≥mo podr√≠as hacerlo:

python

Copiar
from pyspark.sql import SparkSession
import requests
import pandas as pd

# Inicializa la sesi√≥n de Spark
spark = SparkSession.builder.appName("EurostatData").getOrCreate()

# URL de la API de Eurostat (ejemplo)
url = "https://ec.europa.eu/eurostat/sdmx/rest/data/TEN_BUS_FIN_A/EUR/DEP_RDP_GVA?format=csv"

# Descarga los datos
response = requests.get(url)
response.raise_for_status()  # Lanza una excepci√≥n si hay un error

# Lee los datos con pandas
df_pandas = pd.read_csv(response.text, sep=';')

# Convierte el DataFrame de pandas a un DataFrame de Spark
df_spark = spark.createDataFrame(df_pandas)

# Muestra los datos
df_spark.show()
4. Siguientes Pasos:

Limpieza de Datos: Eliminar columnas irrelevantes, convertir tipos de datos, manejar valores faltantes.
Ingenier√≠a de Caracter√≠sticas: Crear nuevas variables a partir de las existentes (ej., tasas de crecimiento del PIB).
Modelado de Riesgos: Aplicar t√©cnicas de modelado de riesgos (ej., Value at Risk - VaR, Expected Shortfall - ES).



Otro paso o ejemplo:

ejemplo de script en PySpark que puedes adaptar para tu proyecto de Modelado de Riesgos de Mercado usando datos descargados desde STOXX.com. Este script asume que ya tienes el archivo hist√≥rico (por ejemplo, h_sx5e.txt) descargado con autenticaci√≥n v√≠a curl o SFTP.

‚öôÔ∏è Script PySpark para c√°lculo de m√©tricas de riesgo
python
from pyspark.sql import SparkSession
from pyspark.sql.functions import col, lag, stddev, avg, max, min
from pyspark.sql.window import Window

# 1Ô∏è‚É£ Inicializa Spark
spark = SparkSession.builder \
    .appName("EuroStoxx50_RiskModeling") \
    .getOrCreate()

# 2Ô∏è‚É£ Carga el archivo hist√≥rico descargado desde STOXX
# Asume formato delimitado por tabulaciones o comas
df = spark.read.csv("h_sx5e.txt", sep="\t", header=True, inferSchema=True)

# 3Ô∏è‚É£ Limpieza y selecci√≥n de columnas relevantes
df_clean = df.select(
    col("Date").cast("date"),
    col("Close").cast("double")
).dropna()

# 4Ô∏è‚É£ C√°lculo de retornos diarios
windowSpec = Window.orderBy("Date")
df_returns = df_clean.withColumn("PrevClose", lag("Close").over(windowSpec))
df_returns = df_returns.withColumn("Return", (col("Close") - col("PrevClose")) / col("PrevClose"))

# 5Ô∏è‚É£ Volatilidad hist√≥rica (desviaci√≥n est√°ndar de retornos)
volatility = df_returns.select(stddev("Return").alias("Volatility")).collect()[0]["Volatility"]

# 6Ô∏è‚É£ Drawdown m√°ximo
df_returns = df_returns.withColumn("RollingMax", max("Close").over(windowSpec))
df_returns = df_returns.withColumn("Drawdown", (col("Close") - col("RollingMax")) / col("RollingMax"))
max_drawdown = df_returns.select(min("Drawdown").alias("MaxDrawdown")).collect()[0]["MaxDrawdown"]

# 7Ô∏è‚É£ Value at Risk (VaR) param√©trico al 95%
mean_return = df_returns.select(avg("Return")).collect()[0][0]
std_return = df_returns.select(stddev("Return")).collect()[0][0]
VaR_95 = mean_return - 1.65 * std_return

# 8Ô∏è‚É£ Resultados
print(f"Volatilidad hist√≥rica: {volatility:.4f}")
print(f"Drawdown m√°ximo: {max_drawdown:.4f}")
print(f"VaR 95% param√©trico: {VaR_95:.4f}")
üì¶ Estructura del proyecto como entregable t√©cnico
üîπ Carpeta data/
h_sx5e.txt ‚Üí hist√≥rico del √≠ndice

composition.csv ‚Üí composici√≥n actual del √≠ndice (opcional)

üîπ Carpeta notebooks/
Exploraci√≥n inicial

Visualizaci√≥n de retornos y drawdown

üîπ Carpeta scripts/
risk_modeling.py ‚Üí script principal (como el de arriba)

üîπ Carpeta docs/
README.md ‚Üí descripci√≥n del proyecto

methodology.pdf ‚Üí resumen de m√©tricas y fuentes